<div class="container">
  <h1>{{ 'submittedProjects.communityProjects' | translate }}</h1>
  
  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>{{ 'common.loading' | translate }}</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    <i class="material-icons">error</i>
    <h3>Error Loading Projects</h3>
    <p>{{ errorMessage }}</p>
    <button (click)="retryLoading()" class="retry-btn">{{ 'common.retry' | translate }}</button>
  </div>

  <!-- Content (only show when not loading and no error) -->
  <div *ngIf="!loading && !error">
    <mat-form-field appearance="outline">
      <mat-label>{{ 'common.search' | translate }}</mat-label>
      <input style="color: var(--text-color);" matInput (keyup)="applyFilter($event)" placeholder="{{ 'common.searchPlaceholder' | translate }}">
      <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>

    <div class="projects-table" *ngIf="dataSource.data.length > 0">
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>{{ 'submittedProjects.tableHeaders.title' | translate }}</th>
          <th>{{ 'submittedProjects.tableHeaders.description' | translate }}</th>
          <th>{{ 'submittedProjects.tableHeaders.submissionDate' | translate }}</th>
          <th>{{ 'submittedProjects.tableHeaders.lastUpdated' | translate }}</th>
          <th>{{ 'submittedProjects.tableHeaders.status' | translate }}</th>
          <th>{{ 'submittedProjects.tableHeaders.actions' | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let project of paginatedData; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ project.title }}</td>
          <td>{{ project.description }}</td>
          <td>{{ project.dateOfSubmission | date }}</td>
          <td>{{ project.lastUpdated | date }}</td>
          <td [class]="getStatusClass(project.status)">{{ getDisplayStatus(project.status) }}</td>
          <td>
            <button class="icon-button" (click)="viewProjectDetails(project)">
              <i class="material-icons">visibility</i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

    <div class="no-projects" *ngIf="dataSource.data.length === 0">
      <div class="no-projects-content">
        <i class="material-icons">folder_open</i>
        <h3>{{ 'common.noProjects' | translate }}</h3>
        <p>{{ 'common.noProjectsMessage' | translate }}</p>
      </div>
    </div>
    
    <div class="pagination" *ngIf="dataSource.data.length > 0">
      <button (click)="previousPage()" [disabled]="currentPage === 0">
        <i class="material-icons">chevron_left</i>
      </button>
      <span>{{ currentPage + 1 }} / {{ totalPages }}</span>
      <button (click)="nextPage()" [disabled]="currentPage === totalPages - 1">
        <i class="material-icons">chevron_right</i>
      </button>
      <select [(ngModel)]="pageSize" (change)="onPageSizeChange()">
        <option *ngFor="let size of pageSizeOptions" [value]="size">{{ size }}</option>
      </select>
    </div>
  </div>
</div>
