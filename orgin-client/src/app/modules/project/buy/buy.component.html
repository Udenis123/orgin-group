<div class="buy-container">
  <!-- Loading State -->
  <div *ngIf="loading" class="loading">
    <p>{{ 'buy.loading' | translate }}</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error">
    <p>{{ error }}</p>
  </div>

  <!-- Project Details -->
  <div *ngIf="project && !loading" class="project-details">
    <div class="project-header">
      <img [src]="project.image" [alt]="project.title" class="project-image">
      <h1>{{ project.title }}</h1>
    </div>
    
    <div class="project-info">
      <div class="info-grid">
        <div class="info-item">
          <strong>{{ 'buy.type' | translate }}:</strong> {{ project.type }}
        </div>
        <div class="info-item">
          <strong>{{ 'buy.category' | translate }}:</strong> {{ project.category }}
        </div>
        <div class="info-item">
          <strong>{{ 'buy.status' | translate }}:</strong> {{ project.status }}
        </div>
        <div class="info-item">
          <strong>{{ 'buy.owner' | translate }}:</strong> {{ project.owner }}
        </div>
      </div>
      
      <p class="project-description">
        {{ truncateText(project.description, 80) }}
        <button 
          *ngIf="shouldShowViewMore(project.description, 80)" 
          class="view-more-btn" 
          (click)="showFullText(project.description, 'Project Description')"
        >
          view more
        </button>
      </p>
      
      <div class="purchase-options">
        <h3>{{ 'buy.purchaseOptions' | translate }}</h3>
        
        <div class="buy-options" *ngIf="showBuyOptions">
          <label>
            <input type="radio" name="buyOption" 
                   [(ngModel)]="buyOption" value="buy without ownership">
            {{ 'buy.withoutOwnership' | translate }}
            <span class="price">(Price: 1,000,000 RWF)</span>
          </label>
          
          <label>
            <input type="radio" name="buyOption" 
                   [(ngModel)]="buyOption" value="buy with ownership">
            {{ 'buy.withOwnership' | translate }}
            <span class="price">(Price: 1,500,000 RWF)</span>
          </label>
        </div>

        <div class="buy-options" *ngIf="!showBuyOptions && project?.purpose === 'buy without ownership'">
          <label>
            <input type="radio" name="buyOption" 
                   [(ngModel)]="buyOption" value="buy without ownership" checked>
            {{ 'buy.withoutOwnership' | translate }}
            <span class="price">(Price: 1,000,000 RWF)</span>
          </label>
        </div>

        <div class="buy-options" *ngIf="!showBuyOptions && project?.purpose === 'buy with ownership'">
          <label>
            <input type="radio" name="buyOption" 
                   [(ngModel)]="buyOption" value="buy with ownership" checked>
            {{ 'buy.withOwnership' | translate }}
            <span class="price">(Price: 1,500,000 RWF)</span>
          </label>
        </div>

        <div class="development-option">
          <label>
            <input type="checkbox" [(ngModel)]="continueDevelopment">
            {{ 'buy.continueDevelopment' | translate }}
            <span class="price">(+300,000 RWF)</span>
          </label>
        </div>

        <div class="total-price">
          <h4>{{ 'buy.totalPrice' | translate }}: {{ getTotalPrice() | currency:'RWF ' }}</h4>
        </div>
      </div>

      <div class="project-actions">
        <button 
          *ngIf="project?.isBuy" 
          class="buy-btn app-buy-btn"
          (click)="buyNow()"
        >
          {{ 'buy.buyNow' | translate }}
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Popup Modal for Full Text -->
<div class="popup-overlay" *ngIf="showPopup" (click)="closePopup()">
  <div class="popup-content" (click)="$event.stopPropagation()">
    <div class="popup-header">
      <h3>{{ popupTitle }}</h3>
      <button class="popup-close" (click)="closePopup()">
        <i class="material-icons">close</i>
      </button>
    </div>
    <div class="popup-body">
      <p>{{ popupContent }}</p>
    </div>
  </div>
</div>
