<div class="bookmarked-container">
  <h2>{{ "bookmarked.title" | translate }}</h2>

  <!-- Loading Spinner -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner">
      <div class="spinner"></div>
      <p>{{ "bookmarked.loading" | translate }}</p>
    </div>
  </div>

  <!-- Project Grid - Only show when not loading and has projects -->
  <div class="project-grid" *ngIf="!isLoading && projects.length > 0">
    <div *ngFor="let project of projects" class="project-card">
      <img
        [src]="project.projectUrl || 'assets/images/default-project.jpg'"
        [alt]="project.projectName"
      />
      <div class="project-details">
        <h3>
          {{ truncateText(project.projectName, 30) }}
          <button 
            *ngIf="shouldShowViewMore(project.projectName, 30)" 
            class="view-more-btn" 
            (click)="showFullText(project.projectName, 'Project Name')"
          >
            view more
          </button>
        </h3>
        <p class="description">
          {{ truncateText(project.projectDescription, 80) }}
          <button 
            *ngIf="shouldShowViewMore(project.projectDescription, 80)" 
            class="view-more-btn" 
            (click)="showFullText(project.projectDescription, 'Description')"
          >
            view more
          </button>
        </p>
        <div class="project-stats">
          <div class="stat">
            <span>{{ "bookmarked.category" | translate }}</span>
            <strong>{{ project.category }}</strong>
          </div>
          <div class="stat">
            <span>{{ "bookmarked.bookmarkedOn" | translate }}</span>
            <strong>{{ project.bookmarkedDate | date : "mediumDate" }}</strong>
          </div>
          <div class="stat">
            <span>{{ "bookmarked.status" | translate }}</span>
            <strong>{{ project.analyticStatus }}</strong>
          </div>
          <div class="stat">
            <span>{{ "bookmarked.purpose" | translate }}</span>
            <strong>
              {{ truncateText(project.projectPurpose, 25) }}
              <button 
                *ngIf="shouldShowViewMore(project.projectPurpose, 25)" 
                class="view-more-btn" 
                (click)="showFullText(project.projectPurpose, 'Project Purpose')"
              >
                view more
              </button>
            </strong>
          </div>
        </div>
        <div class="project-actions">
          <button (click)="viewAnalytics(project.projectId)">
            {{ "bookmarked.viewAnalytics" | translate }}
          </button>
          <button
            (click)="removeBookmark(project.projectId)"
            class="remove-btn"
          >
            {{ "bookmarked.remove" | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- No Projects Message - Only show when not loading and no projects -->
  <div *ngIf="!isLoading && projects.length === 0" class="no-projects">
    <p>{{ "bookmarked.noProjects" | translate }}</p>
  </div>
</div>

<!-- Popup Modal for Full Text -->
<div class="popup-overlay" *ngIf="showPopup" (click)="closePopup()">
  <div class="popup-content" (click)="$event.stopPropagation()">
    <div class="popup-header">
      <h3>{{ popupTitle }}</h3>
      <button class="popup-close" (click)="closePopup()">
        <i class="material-icons">close</i>
      </button>
    </div>
    <div class="popup-body">
      <p>{{ popupContent }}</p>
    </div>
  </div>
</div>
