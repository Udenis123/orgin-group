<div class="container">
  <h2>Community Project Update</h2>
  
  <div *ngIf="isLoading" class="loading">
    Loading project data...
  </div>

  <div *ngIf="!isLoading">
    <div class="stepper">
      <div *ngFor="let step of steps; let i = index" 
           [class.active]="currentStep === i"
           (click)="goToStep(i)">
        {{ step }}
      </div>
    </div>

    <form [formGroup]="projectForm" (ngSubmit)="onSubmit()">
      <!-- Personal Information Step -->
      <div *ngIf="currentStep === 0" class="card">
        <div class="card-header">Personal Information</div>
        <div class="card-body">
          <div class="form-group">
            <label>Full Name</label>
            <input type="text" formControlName="fullName">
          </div>
          <div class="form-group">
            <label>Professional Status</label>
            <input type="text" formControlName="professionalStatus">
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" formControlName="email">
          </div>
          <div class="form-group">
            <label>Phone</label>
            <input type="tel" formControlName="phone">
          </div>
          <div class="form-group">
            <label>LinkedIn</label>
            <input type="url" formControlName="linkedin">
          </div>
        </div>
      </div>

      <!-- Project Information Step -->
      <div *ngIf="currentStep === 1" class="card">
        <div class="card-header">Project Information</div>
        <div class="card-body">
          <div class="form-group">
            <label>Project Name</label>
            <input type="text" formControlName="projectName">
          </div>
          <div class="form-group">
            <label>Category</label>
            <select formControlName="category">
              <option *ngFor="let category of projectCategories" [value]="category">
                {{ category }}
              </option>
            </select>
          </div>
          <div class="form-group">
            <label>Location</label>
            <input type="text" formControlName="location">
          </div>
          <div class="form-group">
            <label>Description</label>
            <textarea formControlName="description"></textarea>
          </div>
          <div class="form-group">
            <label>Project Thumbnail</label>
            <input type="file" (change)="onFileChange($event, 'projectThumbnail')">
          </div>
        </div>
      </div>

      <!-- Team Requirements Step -->
      <div *ngIf="currentStep === 2" class="card mb-3">
        <div class="card-header">Team Requirements</div>
        <div class="card-body">
          <div class="row" *ngFor="let member of requiredMembers.controls; let i = index">
            <div class="col-md-6 form-group">
              <label>Profession</label>
              <input type="text" class="form-control" [formControl]="getProfessionControl(i)" placeholder="Enter profession">
            </div>
            <div class="col-md-6 form-group">
              <label>Quantity</label>
              <input type="number" class="form-control" [formControl]="getQuantityControl(i)" min="0" placeholder="Enter quantity">
            </div>
          </div>
          <button type="button" class="btn btn-primary mt-3" (click)="addMember()">
            Add Another Member
          </button>
        </div>
      </div>

      <!-- Step 4: Review and Submit -->
      <div *ngIf="currentStep === 3" class="card mb-3">
        <div class="card-header">Review and Submit</div>
        <div class="card-body">
          <h5>Review Your Submission</h5>
          <table class="table table-bordered">
            <thead>
              <tr>
                <th>Field</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let field of getFormData()">
                <td>{{ field.label }}</td>
                <td>{{ field.value }}</td>
              </tr>
            </tbody>
          </table>

          <!-- Confirmation Statement -->
          <div class="form-group mt-4">
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="confirmationCheckbox" formControlName="confirmationCheckbox" required>
              <label class="form-check-label" for="confirmationCheckbox">
                I confirm that all information provided is accurate
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Navigation Buttons -->
      <div class="text-center">
        <button type="button" class="btn btn-secondary me-2" *ngIf="currentStep > 0" (click)="previousStep()">
          {{ 'PREVIOUS' | translate }}
        </button>
        <button type="button" class="btn btn-success me-2" *ngIf="currentStep < steps.length - 1" (click)="nextStep()">
          {{ 'SAVE & CONTINUE' | translate }}
        </button>
        <button type="button" class="btn btn-danger me-2" (click)="onClear()">
          {{ 'CLEAR' | translate }}
        </button>
        <button type="submit" class="btn btn-success" *ngIf="currentStep === steps.length - 1" [disabled]="!projectForm.valid || isSubmitting">
          {{ isSubmitting ? 'UPDATING...' : 'UPDATE PROJECT' | translate }}
        </button>
      </div>
    </form>
  </div>
</div>
